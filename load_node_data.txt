// 1. Load Case Nodes
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Jamedw/FALL2025_CSC480/refs/heads/main/Case.csv' AS row
MERGE (c:Case {id: row.id})
SET 
    c.name = row.name,
    c.status = row.status,
    c.dateOpened = date(row.dateOpened);


LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Jamedw/FALL2025_CSC480/refs/heads/main/Person.csv' AS row
// 1. FIX ID: Use square bracket notation for column header 'id:ID(Person)'
MERGE (p:Person {id: row['id']}) 
SET 
    p.name = row.name,
    p.type = row.type,
    p.status = row.status,
    // 2. FIX DATE: Use CASE to handle 'N/A', empty strings, or nulls
    p.dob = CASE 
                WHEN row.dob IS NULL OR row.dob = '' OR row.dob = 'N/A' 
                THEN NULL 
                ELSE date(row.dob) 
            END;


// 3. Load Location Nodes
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Jamedw/FALL2025_CSC480/refs/heads/main/Location.csv' AS row
MERGE (l:Location {id: row.id})
SET 
    l.name = row.name,
    l.type = row.type,
    l.address = row.address,
    l.city = row.city;


LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Jamedw/FALL2025_CSC480/refs/heads/main/Event.csv' AS row
// FIX 1: Use square bracket notation for the ID column 'id:ID(Event)'
MERGE (e:Event {id: row['id']})
SET 
    e.type = row.type,
    e.description = row.description,
    // FIX 2 & 3: Use CASE for null/empty checks AND replace the space with 'T' for datetime()
    e.date = CASE 
                WHEN row.date IS NULL OR row.date = '' 
                THEN NULL 
                ELSE datetime(replace(row.date, ' ', 'T')) 
            END;


// 5. Load Evidence Nodes
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/Jamedw/FALL2025_CSC480/refs/heads/main/Evidence.csv' AS row
MERGE (ev:Evidence {id: row.id})
SET 
    ev.type = row.type,
    ev.status = row.status,
    ev.description = row.description;

